<html>
<head>
<title>How to Use Husky and Git Hooks to Automate Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何使用Husky和Git挂钩来自动化操作</h1>
<blockquote>原文：<a href="https://www.gitkraken.com/blog/husky-git-hooks#0001-01-01">https://www.gitkraken.com/blog/husky-git-hooks#0001-01-01</a></blockquote><div><div class="elementor-widget-container">
			
<p>Git挂钩是一个适合的解决方案，适用于寻求在团队中实现一致的策略和过程的组织。首先，它们使团队能够根据特定的Git操作运行定制脚本。将自动化构建到您的<a href="https://www.gitkraken.com/git-client" target="_blank" rel="noreferrer noopener"> Git客户端</a>中有助于消除人为错误的可能性，并且不费吹灰之力就能改进工作流程。</p>



<p>这里我们将探索Husky如何在JS项目中使用Git钩子。首先，让我们从基础开始:</p>



<p aria-hidden="true" class="wp-block-spacer">什么是Git挂钩？</p>



<h2><a href="https://www.gitkraken.com/learn/git/tutorials/how-to-create-git-hooks" target="_blank" rel="noreferrer noopener"> Git挂钩</a>是开发人员<a href="https://git-scm.com/docs/githooks" target="_blank" rel="noreferrer noopener">可以设置的脚本，当Git生命周期中发生某些事件时运行</a>。有一些流行的方法可以利用Git挂钩来通过自动化来简化工作流。</h2>



<p>对于开发人员来说，在自动化的帮助下<a href="https://www.gitkraken.com/blog/shell-scripting" target="_blank" rel="noreferrer noopener">运行定制代码任务的脚本</a>并执行标准可能是有用的，因为它简化了操作。提交的某些阶段，比如之前和之后，是开始使用Git挂钩的好方法。</p>



<p>对于开发人员来说，在自动化的帮助下<a href="https://www.gitkraken.com/blog/shell-scripting" target="_blank" rel="noreferrer noopener">运行定制代码任务的脚本</a>并执行标准可能是有用的，因为它简化了操作。提交的某些阶段，比如之前和之后，是开始使用Git挂钩的好方法。</p>



<p aria-hidden="true" class="wp-block-spacer">GitKraken客户端支持许多流行的Git挂钩，包括提交、检验、合并、重置等挂钩。<br/></p>



<div class="callout">
<div class="callout-content">
<p>什么是哈士奇？</p>

</div>
</div>



<p aria-hidden="true" class="wp-block-spacer">许多使用Git挂钩的开发人员也使用Husky来帮助管理脚本。Husky是一个工具，<a href="https://www.npmjs.com/package/husky" target="_blank" rel="noreferrer noopener">帮助开发人员更有效地使用Git挂钩工作</a>，并运行各个阶段需要工作的所有脚本。</p>



<h2>通过简化设置Git挂钩的过程，开发人员<a href="https://www.waveapps.com/freelancing/back-end-development-resources" target="_blank" rel="noreferrer noopener">可以更快地创建有效的解决方案</a>。Husky在package.json文件中工作，包括一个对象，该对象配置Husky运行某些脚本，然后Husky在Git生命周期的特定点管理脚本。</h2>



<p>安装Husky</p>



<p>如果您想使用Git挂钩以这种方式优化您的项目，您需要从安装Husky开始。您可以通过输入以下命令来完成此操作:</p>



<p aria-hidden="true" class="wp-block-spacer"><code>$ npm install husky --save-dev</code></p>



<h2>在Husky完成安装后，运行一个允许启用Git挂钩的命令:</h2>



<p><code>$ npx husky install</code></p>



<p>接下来，您将需要调整package.json文件。最后一个命令在安装过程结束后运行:</p>



<p><code>// package.json</code></p>



<p><code>{</code></p>



<p><code>  "scripts": {</code></p>



<p><code>    "prepare": "husky install"</code></p>



<p><code>  }</code></p>



<p><code>}</code></p>



<p>如果您在GUI中收到错误响应，您必须添加并设置环境路径。</p>



<p>根据您选择的环境，位置会有所不同。在这种情况下，我们将使用asdf-nodejs，因此我们的environment.plist文件将如下所示:</p>



<p><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</code></p>



<p><code>&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</code></p>



<p><code>&lt;plist version="1.0"&gt;</code></p>



<p><code>  &lt;dict&gt;</code></p>



<p><code>    &lt;key&gt;PATH&lt;/key&gt;</code></p>



<p><code>&lt;string&gt;/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/Users/brunobrito/.asdf/shims&lt;/string&gt;</code></p>



<p><code> &lt;/dict&gt;</code></p>



<p><code>&lt;/plist&gt;</code></p>



<p>现在，是时候保存文件了。为此，重启Git客户端，并返回到命令行来创建一个钩子。</p>



<p>创建Git挂钩</p>



<p>虽然Git挂钩可以用来创建许多自动化，但是有几个挂钩在开发人员中一直很受欢迎。让我们进一步了解如何验证分支名称、林挺提交消息、林挺代码、压缩分段映像，以及使用Husky和Git挂钩运行测试。</p>



<p>现在，是时候保存文件了。为此，重启Git客户端，并返回到命令行来创建一个钩子。</p>



<p aria-hidden="true" class="wp-block-spacer">用Git挂钩验证分支名称</p>



<h2>这对于确保每个分支<a href="https://www.gitkraken.com/blog/trunk-based-development" target="_blank" rel="noreferrer noopener">遵循特定的模式</a>尤其方便。Validate-branch-name是一个npm包。如果您了解regex，这个包带有可以定制的预设默认值。</h2>



<p>使用以下命令开始安装此软件包:</p>



<p aria-hidden="true" class="wp-block-spacer"><code>$ npm install validate-branch-name --save-dev</code></p>



<h3>接下来，您可以利用预提交挂钩将它添加到Husky:</h3>



<p><code>$ npx husky add .husky/pre-commit "npx validate-branch-name"</code></p>



<p>使用以下命令开始安装此软件包:</p>



<p>用Git钩子压缩图像</p>



<p>一些框架比其他框架更好地呈现图像，并且每次都很难记住运行ImageOptim。幸运的是，开发人员可以使用一个脚本来自动压缩您添加到项目中的图像。此示例将用于ImageOptim-CLI。</p>



<p>您将使用以下命令开始安装过程:</p>



<p aria-hidden="true" class="wp-block-spacer"><code>$ npm install -g imageoptim-cli</code></p>



<h3>接下来，将imageoptim命令添加到lint-stage，因为您只想压缩暂存文件。</h3>



<p><code>// package.json</code></p>



<p><code>{</code></p>



<p><code>  "scripts": {</code></p>



<p><code>    "prepare": "husky install"</code></p>



<p><code>  },</code></p>



<p><code>  "lint-staged": {</code></p>



<p><code>    "**/*.js": "prettier --write --ignore-unknown",</code></p>



<p><code>    "**/*": "imageoptim"</code></p>



<p><code>  },</code></p>



<p><code>  ...</code></p>



<p><code>}</code></p>



<p>带Git挂钩的林挺代码</p>



<p>要用Git挂钩链接代码，开发人员需要使用两个节点包:lint-staged和appearlier。</p>



<p>Lint-staged非常适合跨暂存文件运行检查。后来，漂亮的负责林挺代码。</p>



<p>首先使用以下命令安装这两个软件包:</p>



<p aria-hidden="true" class="wp-block-spacer"><code>$ npm install lint-staged prettier --save-dev</code></p>



<h3><code>$ npx husky add .husky/pre-commit "npx lint-staged"</code></h3>



<p>接下来，在package.json文件中设置lint-staged:</p>



<p><code>// package.json</code></p>



<p><code>{</code></p>



<p><code>  "scripts": {</code></p>



<p><code>    "prepare": "husky install"</code></p>



<p><code>  },</code></p>



<p><code>  "lint-staged": {</code></p>



<p><code>    "**/*.js": "prettier --write --ignore-unknown"</code></p>



<p><code>  },</code></p>



<p><code>  ...</code></p>



<p><code>}</code></p>



<p>用Git挂钩运行测试</p>



<p>您可以使用Husky和Git挂钩添加的另一个简单的自动化功能是运行测试，这会让您的生活更加轻松。对于这个例子，我们将安装Jest，这是一个经常被<a href="https://www.gitkraken.com/blog/quality-assurance-engineer" target="_blank" rel="noreferrer noopener">质量控制工程师</a>用于运行测试的工具:</p>



<p><code>$ npm install --save-dev jest</code></p>



<p>然后，向package.json文件添加一个测试脚本:</p>



<p><code>// package.json</code></p>



<p aria-hidden="true" class="wp-block-spacer"><code>{</code></p>



<h3><code>  "scripts": {</code></h3>



<p><code>    "prepare": "husky install",</code></p>



<p><code>    "test": "jest"</code></p>



<p><code>  },</code></p>



<p><code>  "lint-staged": {</code></p>



<p><code>    "**/*.js": "prettier --write --ignore-unknown",</code></p>



<p><code>    "**/*": "imageoptim"</code></p>



<p><code>  },</code></p>



<p><code>  ...</code></p>



<p>要使用Git挂钩完成自动化设置，您必须使用以下命令将npm测试脚本添加到预提交挂钩:</p>



<p><code>$ npx husky add .husky/pre-commit "npm test"</code></p>



<p>跳过Git挂钩</p>



<p>自动化对于Git开发人员来说非常重要，原因有几个。首先，内置的自动化功能有助于保护您的环境免受入侵。自动化使团队能够轻松地跟踪提交，并确保在存储库中只进行允许的更改，防止恶意代码被注入到项目中。</p>



<p>虽然开发人员不太可能跳过Git钩子，但是当代码需要一点人类的TLC时，跳过钩子是绕过这些自动化的一种方式。</p>



<p>您可以使用以下命令绕过Git挂钩:</p>



<p><code>$ git commit -m "skipping hooks" --no-verify</code></p>



<p>现在，您可以手动执行任务，而无需脚本自动运行。</p>



<p aria-hidden="true" class="wp-block-spacer"/>



<h2>Git Hooks和Husky入门</h2>



<p>开始使用Husky和Git挂钩是一个简单的过程，可以节省开发人员不必要的击键和大量时间。</p>



<p>Git挂钩可以被配置为创建许多自动化功能，以改进工作流并在开发人员之间强制执行代码标准。这是在使用Git时，开始使用Git钩子和Husky自动化常见任务的五种方法。</p>



<p>您可以使用以下命令绕过Git挂钩:</p>



<p>您可以使用GitKraken客户端通过内置的终端开始使用Husky和Git挂钩。今天就自己试试吧。<br/></p>



<p>现在，您可以手动执行任务，而无需脚本自动运行。</p>



<p aria-hidden="true" class="wp-block-spacer"/>



<h2>Git Hooks和Husky入门</h2>



<p>开始使用Husky和Git挂钩是一个简单的过程，可以节省开发人员不必要的击键和大量时间。</p>



<p>Git挂钩可以被配置为创建许多自动化功能，以改进工作流并在开发人员之间强制执行代码标准。这是在使用Git时，开始使用Git钩子和Husky自动化常见任务的五种方法。</p>



<p aria-hidden="true" class="wp-block-spacer"/>



<div class="callout">
<div class="callout-content">
<p>您可以使用GitKraken客户端通过内置的终端开始使用Husky和Git挂钩。今天就自己试试吧。<br/></p>

</div>
</div>
		</div>
				</div>    
</body>
</html>